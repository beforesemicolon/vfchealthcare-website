function fileToBase64(r){return new Promise((a,e)=>{const t=new FileReader;t.readAsDataURL(r),t.onload=()=>a(t.result.split(",")[1]),t.onerror=s=>e(s)})}let currentForm={};async function SubmitForm(r){const a=new FormData(currentForm.form),e={};for(let[t,s]of a)s instanceof File?(e[t]=await fileToBase64(s),e.filename=s.name):e[t]=s.trim();emailjs.send("beforesemi",currentForm.emailTemplate,{...e,"g-recaptcha-response":r}).then(()=>{currentForm.form.reset(),currentForm.form.className="success-request"}).catch(t=>{console.error(t),currentForm.form.className="failed-request"}),scrollTo(currentForm.form.clientTop,currentForm.form.clientLeft),grecaptcha.reset()}function handleForm(r,a="vfc_service_request"){const e=document.getElementById(r),t=e.querySelector(".success-request-message button"),s=e.querySelector(".failed-request-message button");[t,s].forEach(c=>{c.addEventListener("click",()=>{e.className=""})}),e.addEventListener("submit",c=>{c.preventDefault(),e.className="",e.checkValidity()?(e.className="sending-form",currentForm={form:e,emailTemplate:a},grecaptcha.execute()):(e.className="invalid-form",scrollTo(e.clientTop,e.clientLeft))})}
